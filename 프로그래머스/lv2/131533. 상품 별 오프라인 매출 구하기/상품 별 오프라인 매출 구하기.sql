# PRODUCT 테이블, OFFILINE_SALE 테이블
# 상품코드 별 매출액(판매가*판매량) 합계 출력
# 매출액 기준 내림차순, 상품코드 기준 오름차순 정렬

SELECT P.PRODUCT_CODE, SUM(P.PRICE * O.SALES_AMOUNT) SALES
FROM PRODUCT P
LEFT JOIN OFFLINE_SALE O
ON P.PRODUCT_ID = O.PRODUCT_ID
GROUP BY O.PRODUCT_ID
ORDER BY SALES DESC, P.PRODUCT_CODE ASC;